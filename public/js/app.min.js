function isset(e){return e!==void 0&&null!==e}function Ajax(e,t){this.post=[],this.elm=void 0,this.loader=void 0,e&&(this.elm=e,this.loader=document.createElement("span"),this.loader.className="loading",this.loader.innerHTML='<i class="n1"></i><i class="n2"></i><i class="n3"></i>',this.elm.parentNode.replaceChild(this.loader,this.elm)),this.post.push("action="+t),this.post.push("page="+page),this.addParam=function(e,t){this.post.push(e+"="+encodeURIComponent(t))},this.send=function(e,t){var n=this,a=new XMLHttpRequest;a.open("POST",ajax_url),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(this.post.join("&")),a.onreadystatechange=function(){if(a.readyState==a.DONE){if(200==a.status){var o=JSON.parse(a.responseText);"success"==o.status?e!==void 0&&e(o):t!==void 0&&t(o)}else 403==a.status?alert(m_error_login):alert(m_error_ajax);n.cancel()}}},this.cancel=function(){this.loader&&this.loader.parentNode.replaceChild(this.elm,this.loader)}}function onload_tags(){function e(){for(var e=r.querySelectorAll(".tag"),t=[],n=0;e.length>n;n++)t.push(e[n].innerHTML);c.value=t.join(",")}function t(t){return t.target.parentNode.removeChild(t.target),e(),!1}function n(e){var n=document.createElement("a");n.href="#",n.className="tag",n.innerHTML=e,l.appendChild(n),n.onclick=t}function a(){""!==i.value&&(n(i.value),i.value="",e())}function o(){if(""!==c.value)for(var e=c.value.split(/,/),t=0;e.length>t;t++)n(e[t])}var r=document.querySelector(".editTags"),l=r.querySelector("span"),c=document.getElementById("tags"),i=document.getElementById("addTag"),d=document.querySelector(".pick-tag"),s=d.querySelectorAll("span"),u=!1;d.onmousedown=function(e){"visible"==e.target.className&&(i.value=e.target.innerHTML,a(),u=!0)},i.onkeydown=function(e){if("keyCode"in e&&(13==e.keyCode||188==e.keyCode)||"key"in e&&("Enter"==e.key||","==e.key))return a(),i.blur(),i.focus(),!1;if("keyCode"in e&&9==e.keyCode||"key"in e&&"Tab"==e.key){var t=form.list.querySelector(".visible");return null!==t&&(i.value=t.innerHTML,a(),i.blur(),i.focus()),!1}},i.onfocus=function(){var e=i.getBoundingClientRect();d.style.left=e.left+"px",d.style.top=e.bottom+"px",i.onkeyup()},i.onblur=function(){u?(u=!1,setTimeout("document.getElementById('addTag').focus()",10)):(d.style.left="-9999px",d.style.top="-9999px")},i.onkeyup=function(){for(var e=i.value,t=0;s.length>t;t++)s[t].className=-1===s[t].innerHTML.indexOf(e)?"":"visible"},c.onupdate=o,o()}function show_done(){for(var e=document.querySelectorAll(".done"),t=0;e.length>t;t++)e[t].style.display="block";return!1}function changeNo(e){var t=new Ajax(e,"changeNo");t.addParam("no",no),t.send(function(e){var t=document.querySelector("article");t.innerHTML=e.html})}function next(e){return no++,changeNo(e.target),!1}function previous(e){return no--,changeNo(e.target),!1}function gotoday(e){no=parseInt(e.target.dataset.no,10),changeNo(a_calendar),a_calendar.click()}function draw_calendar(e,t){var n="<tr>",a=new Date,o=new Date;a.setFullYear(t),a.setMonth(e),a.setDate(1);var r=a.getDay()-1;0>r&&(r=6);for(var l=0;r>l;l++)n+='<td class="empty"></td>';for(;a.getMonth()==e;){var c=(a.getTime()-o.getTime())/864e5;c=0>c?-Math.ceil(Math.abs(c)):Math.ceil(c),n+=a.getDate()==o.getDate()&&a.getMonth()==o.getMonth()&&a.getFullYear()==o.getFullYear()?'<td class="td-clk today" data-no="'+c+'">'+a.getDate()+"</td>":'<td class="td-clk" data-no="'+c+'">'+a.getDate()+"</td>",0===a.getDay()&&(n+="</tr><tr>"),a.setDate(a.getDate()+1)}n+="</tr>",document.querySelector(".calendar tbody").innerHTML=n,document.querySelector(".calendar span").innerHTML=mois[e]+" "+t;var i=document.querySelectorAll(".calendar .td-clk");for(l=0;i.length>l;l++)i[l].onclick=gotoday}isset(document.getElementById("logout"))&&(document.getElementById("logout").onclick=function(){return document.getElementById("form-logout").submit(),!1}),isset(document.querySelector(".editTags"))&&onload_tags();var a_done=document.querySelectorAll(".show-done");isset(a_done[0])&&(a_done[0].onclick=show_done),isset(a_done[1])&&(a_done[1].onclick=show_done);var no=0,a_next=document.querySelectorAll(".next");isset(a_next[0])&&(a_next[0].onclick=next),isset(a_next[1])&&(a_next[1].onclick=next);var a_previous=document.querySelectorAll(".previous");isset(a_previous[0])&&(a_previous[0].onclick=previous),isset(a_previous[1])&&(a_previous[1].onclick=previous);var a_edit=document.querySelector(".edit");isset(a_edit)&&(a_edit.onclick=function(){var e=document.querySelector(".display-text"),t=a_edit.dataset.text;return isset(e)?(e.className="display-form",a_edit.dataset.text=a_edit.innerHTML,a_edit.innerHTML=t):(document.querySelector(".display-form").className="display-text",a_edit.dataset.text=a_edit.innerHTML,a_edit.innerHTML=t),!1});var a_delete=document.querySelector(".delete");isset(a_delete)&&(a_delete.onclick=function(){if(confirm(m_confirm_delete)){var e=document.querySelector("article form");e.querySelector(".npt-action").value="delete",e.submit()}return!1});var a_calendar=document.querySelector(".a-calendar");if(isset(a_calendar)){var calendar=document.querySelector(".calendar");a_calendar.onclick=function(e){return e.preventDefault(),e.stopPropagation(),"calendar"==calendar.className?(calendar.className="calendar display",document.querySelector(".div-hover").style.display="block",document.querySelector(".div-hover").onclick=function(){a_calendar.click()}):(calendar.className="calendar",document.querySelector(".div-hover").style.display="none"),!1}}var mois=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],date=new Date,month=date.getMonth(),year=date.getFullYear();draw_calendar(month,year),document.querySelector(".a-prev").onclick=function(e){return e.stopPropagation(),month--,0>month&&(month=11,year--),draw_calendar(month,year),!1},document.querySelector(".a-next").onclick=function(e){return e.stopPropagation(),month++,month>11&&(month=0,year++),draw_calendar(month,year),!1};